// script generated by GPT-o4-mini-high, retrieving GEDI surface elevation data
// 1. Define your AOI
var region = ee.Geometry.Rectangle([
  -53.56939, -11.58850,
  -53.10124, -11.02354
]);

// 2. Pull the list of table IDs into a client-side array
//    (you can also copy/paste the array you printed earlier)
var tableIds = ee.FeatureCollection('LARSE/GEDI/GEDI02_A_002_INDEX')
                  .filterBounds(region)
                  .aggregate_array('table_id')
                  .getInfo();  // <-- brings it into a plain JS array

// 3. Merge them one by one
var merged = ee.FeatureCollection(tableIds[0]);
for (var i = 1; i < tableIds.length; i++) {
  merged = merged.merge(ee.FeatureCollection(tableIds[i]));
}

// 4. Optionally narrow to your box & pick only the fields you want
merged = merged
           .filterBounds(region)
           .select(['latitude','longitude','elevation','rh100']);

// 5. Export the merged FeatureCollection to Drive as CSV
Export.table.toDrive({
  collection: merged,
  description: 'GEDI_L2A_shots_region',
  fileFormat: 'CSV'
});
